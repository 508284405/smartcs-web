<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.leyue.smartcs.knowledge.mapper.EmbeddingMapper">

    <!-- 分页查询向量数据 -->
    <select id="listByDocIdAndStrategyName" resultType="com.leyue.smartcs.knowledge.dataobject.EmbeddingDO">
        SELECT id, doc_id, section_idx, content_snip, model_type, strategy_name, 
               is_deleted, created_by, updated_by, created_at, updated_at
        FROM t_cs_doc_embedding
        WHERE is_deleted = 0
          AND doc_id = #{qry.docId}
          AND (strategy_name = #{qry.strategyName.code} OR strategy_name LIKE CONCAT(#{qry.strategyName.code}, '%'))
        ORDER BY section_idx ASC
    </select>

</mapper> 